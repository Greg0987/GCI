# GCI
 The data and code of paper GCI

The dataset used in paper is [KuaiRec](https://kuairec.com/), which can be downloaded by the link.

# 1. Reconstruction of Image
```bash
cd preprocess
```


## 1.1 Prompt design

Design the prompts to reconstruct the missing images from image modal.
Here are two kinds of prompts, one is a long form of "a micro-vido, keywords are:" and another is tags list directly.
Details in `prompts_long_small.txt`, `prompts_short_small.txt`, `prompts_long_big.txt`, `prompts_short_big.txt`.


## 1.2 Generate images by prompts

We generate images by model [Vis-CPM](https://github.com/OpenBMB/VisCPM?tab=readme-ov-file), or you can choose a suitable model to generate images.


## 1.3 Encode images

Set the vairables of your path of the generated images `images_lp_path` and `images_sp_path` in `encode_images.py`. The generator we use is chinese-clip-vit-base-patch16.
```bash
python encode_images.py
```
Or you can use the encodings we preprocess: `image_small_lp_features.txt`, `image_big_lp_features.txt`, `image_small_sp_features.txt', 'image_small_sp_features.txt', whose images ares generated by different prompts.

## 1.4 Encode CSD
Then get the CSD vectors.
```bash
python encode_csd.py
```

# 2. Construct graph with images similarity
```
cd preprocess
python construct_graph.py
```
THe thresholds of similarities are 0.2, 0.4, 0.6 and 0.8. And the graphs can be seen in `preprocess/img_adj/`.

